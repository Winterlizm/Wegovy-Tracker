<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××¢×§×‘ Wegovy - ×œ×™×–</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            background: linear-gradient(to bottom, #f8fafc, #e0e7ff);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px;
            border-radius: 20px;
            color: white;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #333;
            margin: 10px 0;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9em;
        }
        
        .card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .card h2 {
            color: #333;
            margin-bottom: 20px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            color: #666;
            font-weight: bold;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            transition: transform 0.2s;
        }
        
        .btn:hover {
            transform: scale(1.02);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
            margin-top: 10px;
        }
        
        .btn-edit {
            background: #3b82f6;
            color: white;
            padding: 8px 15px;
            font-size: 14px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
        }
        
        .btn-delete {
            background: #ef4444;
            color: white;
            padding: 8px 15px;
            font-size: 14px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
        }
        
        .btn-export {
            background: #10b981;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
        }
        
        .entries-grid {
            display: grid;
            gap: 15px;
        }
        
        .entry-card {
            border: 2px solid #e5e7eb;
            padding: 20px;
            border-radius: 12px;
            transition: all 0.2s;
        }
        
        .entry-card:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }
        
        .entry-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
        }
        
        .entry-date {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
        }
        
        .entry-actions {
            display: flex;
            gap: 10px;
        }
        
        .entry-data {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .data-item-label {
            color: #666;
            font-size: 0.9em;
        }
        
        .data-item-value {
            font-size: 1.3em;
            font-weight: bold;
        }
        
        .side-effects {
            margin-top: 10px;
            padding: 10px;
            background: #fef3c7;
            border-radius: 6px;
        }
        
        .side-effects-label {
            font-weight: bold;
            color: #92400e;
        }
        
        .side-effects-text {
            margin-right: 5px;
            color: #78350f;
        }
        
        .notes {
            margin-top: 10px;
            padding: 10px;
            background: #f3f4f6;
            border-radius: 6px;
            color: #374151;
        }
        
        .empty-state {
            color: #666;
            text-align: center;
            padding: 40px;
        }
        
        .chart-container {
            width: 100%;
            height: 300px;
            position: relative;
            margin-top: 20px;
        }
        
        canvas {
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>âš–ï¸ ××¢×§×‘ Wegovy ××™×©×™</h1>
            <p style="opacity: 0.9; font-size: 1.1em;">×”××¡×¢ ×©×œ×š ×œ×‘×¨×™××•×ª ×˜×•×‘×” ×™×•×ª×¨ - ×¦×¢×“ ××—×¨ ×¦×¢×“</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div style="font-size: 2em;">ğŸ“…</div>
                <div class="stat-number" id="totalEntries">0</div>
                <div class="stat-label">×™××™ ××¢×§×‘</div>
            </div>
            <div class="stat-card">
                <div style="font-size: 2em;">âš–ï¸</div>
                <div class="stat-number" id="avgWeight">0</div>
                <div class="stat-label">××©×§×œ ×××•×¦×¢ (×§×´×’)</div>
            </div>
            <div class="stat-card">
                <div style="font-size: 2em;">ğŸ“‰</div>
                <div class="stat-number" id="weightChange">0</div>
                <div class="stat-label">×©×™× ×•×™ ×‘××©×§×œ (×§×´×’)</div>
            </div>
            <div class="stat-card">
                <div style="font-size: 2em;">ğŸ’§</div>
                <div class="stat-number" id="avgWater">0</div>
                <div class="stat-label">×œ×™×˜×¨ ××™× ×××•×¦×¢</div>
            </div>
        </div>

        <div class="card" id="chartCard" style="display: none;">
            <h2>ğŸ“Š ×’×¨×£ ×”×ª×§×“××•×ª ××©×§×œ</h2>
            <div class="chart-container">
                <canvas id="weightChart"></canvas>
            </div>
        </div>

        <div class="card">
            <h2 id="formTitle">â• ×”×•×¡×¤×ª ×¨×©×•××” ×—×“×©×”</h2>
            <form id="entryForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="date">×ª××¨×™×š</label>
                        <input type="date" id="date" required>
                    </div>
                    <div class="form-group">
                        <label for="weight">××©×§×œ (×§×´×’)</label>
                        <input type="number" step="0.1" id="weight" placeholder="×œ×“×•×’××”: 75.5">
                    </div>
                    <div class="form-group">
                        <label for="dosage">××™× ×•×Ÿ (mg)</label>
                        <select id="dosage">
                            <option value="">×‘×—×¨×™ ××™× ×•×Ÿ</option>
                            <option value="0.25">0.25 mg</option>
                            <option value="0.5">0.5 mg</option>
                            <option value="1">1 mg</option>
                            <option value="1.7">1.7 mg</option>
                            <option value="2.4">2.4 mg</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="bowelMovements">×™×¦×™××•×ª (××¡×¤×¨)</label>
                        <input type="number" id="bowelMovements" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label for="waterIntake">×©×ª×™×™×ª ××™× (×œ×™×˜×¨)</label>
                        <input type="number" step="0.1" id="waterIntake" placeholder="×œ×“×•×’××”: 2.5">
                    </div>
                    <div class="form-group">
                        <label for="sideEffects">×ª×•×¤×¢×•×ª ×œ×•×•××™</label>
                        <input type="text" id="sideEffects" placeholder="×‘×—×™×œ×”, ×¢×™×™×¤×•×ª, ×•×›×•×³">
                    </div>
                </div>
                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="notes">×”×¢×¨×•×ª</label>
                    <textarea id="notes" placeholder="××™×š ×”×¨×’×©×ª ×”×™×•×? ××” ××›×œ×ª? ×”×¢×¨×•×ª × ×•×¡×¤×•×ª..."></textarea>
                </div>
                <button type="submit" class="btn btn-primary" id="submitBtn">×©××™×¨×ª ×¨×©×•××”</button>
                <button type="button" class="btn btn-secondary" id="cancelBtn" style="display: none;">×‘×™×˜×•×œ ×¢×¨×™×›×”</button>
            </form>
        </div>

        <div class="card">
            <h2>ğŸ“‹ ×”×™×¡×˜×•×¨×™×™×ª ×¨×©×•××•×ª (<span id="entriesCount">0</span>)</h2>
            <div id="entriesList" class="empty-state">
                ×¢×“×™×™×Ÿ ××™×Ÿ ×¨×©×•××•×ª. ×”×ª×—×™×œ×™ ×œ××œ× ××ª ×”×˜×•×¤×¡ ×œ××¢×œ×” ×›×“×™ ×œ×”×ª×—×™×œ ×‘××¢×§×‘! ğŸ’ª
            </div>
        </div>

        <div style="text-align: center;">
            <button class="btn-export" id="exportBtn" style="display: none;">ğŸ’¾ ×™×™×¦×•× × ×ª×•× ×™× ×œ×’×™×‘×•×™</button>
        </div>
    </div>

    <script>
        let entries = [];
        let editingId = null;

        // Load data on page load
        window.addEventListener('DOMContentLoaded', () => {
            loadData();
            setTodayDate();
            renderAll();
        });

        function setTodayDate() {
            document.getElementById('date').valueAsDate = new Date();
        }

        function loadData() {
            const saved = localStorage.getItem('wegovyTracker');
            if (saved) {
                entries = JSON.parse(saved);
            }
        }

        function saveData() {
            localStorage.setItem('wegovyTracker', JSON.stringify(entries));
        }

        document.getElementById('entryForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const entry = {
                date: document.getElementById('date').value,
                weight: document.getElementById('weight').value,
                dosage: document.getElementById('dosage').value,
                bowelMovements: document.getElementById('bowelMovements').value,
                waterIntake: document.getElementById('waterIntake').value,
                sideEffects: document.getElementById('sideEffects').value,
                notes: document.getElementById('notes').value
            };

            if (editingId) {
                const index = entries.findIndex(e => e.id === editingId);
                entries[index] = { ...entry, id: editingId };
                editingId = null;
            } else {
                entry.id = Date.now();
                entries.push(entry);
            }

            entries.sort((a, b) => new Date(b.date) - new Date(a.date));
            saveData();
            resetForm();
            renderAll();
        });

        document.getElementById('cancelBtn').addEventListener('click', () => {
            editingId = null;
            resetForm();
        });

        document.getElementById('exportBtn').addEventListener('click', () => {
            const dataStr = JSON.stringify(entries, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `wegovy-tracker-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
        });

        function resetForm() {
            document.getElementById('entryForm').reset();
            setTodayDate();
            document.getElementById('formTitle').textContent = 'â• ×”×•×¡×¤×ª ×¨×©×•××” ×—×“×©×”';
            document.getElementById('submitBtn').textContent = '×©××™×¨×ª ×¨×©×•××”';
            document.getElementById('cancelBtn').style.display = 'none';
        }

        function editEntry(id) {
            const entry = entries.find(e => e.id === id);
            if (!entry) return;

            editingId = id;
            document.getElementById('date').value = entry.date;
            document.getElementById('weight').value = entry.weight;
            document.getElementById('dosage').value = entry.dosage;
            document.getElementById('bowelMovements').value = entry.bowelMovements;
            document.getElementById('waterIntake').value = entry.waterIntake;
            document.getElementById('sideEffects').value = entry.sideEffects;
            document.getElementById('notes').value = entry.notes;

            document.getElementById('formTitle').textContent = 'âœï¸ ×¢×¨×™×›×ª ×¨×©×•××”';
            document.getElementById('submitBtn').textContent = '×¢×“×›×•×Ÿ ×¨×©×•××”';
            document.getElementById('cancelBtn').style.display = 'block';

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function deleteEntry(id) {
            if (confirm('×”×× ××ª ×‘×˜×•×—×” ×©××ª ×¨×•×¦×” ×œ××—×•×§ ×¨×©×•××” ×–×•?')) {
                entries = entries.filter(e => e.id !== id);
                saveData();
                renderAll();
            }
        }

        function renderAll() {
            renderStats();
            renderChart();
            renderEntries();
        }

        function renderStats() {
            const weightsOnly = entries.filter(e => e.weight);
            const watersOnly = entries.filter(e => e.waterIntake);

            document.getElementById('totalEntries').textContent = entries.length;
            
            const avgWeight = weightsOnly.length > 0
                ? (weightsOnly.reduce((sum, e) => sum + parseFloat(e.weight), 0) / weightsOnly.length).toFixed(1)
                : '0';
            document.getElementById('avgWeight').textContent = avgWeight;

            const weightChange = entries.length >= 2 && entries[0].weight && entries[entries.length - 1].weight
                ? (parseFloat(entries[0].weight) - parseFloat(entries[entries.length - 1].weight)).toFixed(1)
                : '0';
            document.getElementById('weightChange').textContent = weightChange;

            const avgWater = watersOnly.length > 0
                ? (watersOnly.reduce((sum, e) => sum + parseFloat(e.waterIntake), 0) / watersOnly.length).toFixed(1)
                : '0';
            document.getElementById('avgWater').textContent = avgWater;

            document.getElementById('exportBtn').style.display = entries.length > 0 ? 'inline-block' : 'none';
        }

        function renderChart() {
            const chartData = entries
                .filter(e => e.weight)
                .sort((a, b) => new Date(a.date) - new Date(b.date));

            if (chartData.length < 2) {
                document.getElementById('chartCard').style.display = 'none';
                return;
            }

            document.getElementById('chartCard').style.display = 'block';

            const canvas = document.getElementById('weightChart');
            const ctx = canvas.getContext('2d');
            
            // Set canvas size
            canvas.width = canvas.offsetWidth;
            canvas.height = 300;

            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Prepare data
            const weights = chartData.map(e => parseFloat(e.weight));
            const dates = chartData.map(e => {
                const d = new Date(e.date);
                return `${d.getDate()}/${d.getMonth() + 1}`;
            });

            const maxWeight = Math.max(...weights);
            const minWeight = Math.min(...weights);
            const range = maxWeight - minWeight || 1;

            const padding = 60;
            const chartWidth = canvas.width - padding * 2;
            const chartHeight = canvas.height - padding * 2;

            // Draw axes
            ctx.strokeStyle = '#e5e7eb';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, canvas.height - padding);
            ctx.lineTo(canvas.width - padding, canvas.height - padding);
            ctx.stroke();

            // Draw grid
            ctx.strokeStyle = '#f3f4f6';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 5; i++) {
                const y = padding + (chartHeight / 5) * i;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvas.width - padding, y);
                ctx.stroke();
            }

            // Draw line
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 3;
            ctx.beginPath();

            weights.forEach((weight, i) => {
                const x = padding + (chartWidth / (weights.length - 1)) * i;
                const y = canvas.height - padding - ((weight - minWeight) / range) * chartHeight;

                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();

            // Draw points
            ctx.fillStyle = '#667eea';
            weights.forEach((weight, i) => {
                const x = padding + (chartWidth / (weights.length - 1)) * i;
                const y = canvas.height - padding - ((weight - minWeight) / range) * chartHeight;

                ctx.beginPath();
                ctx.arc(x, y, 5, 0, Math.PI * 2);
                ctx.fill();
            });

            // Draw labels
            ctx.fillStyle = '#666';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';

            // X-axis labels (dates)
            dates.forEach((date, i) => {
                const x = padding + (chartWidth / (weights.length - 1)) * i;
                ctx.fillText(date, x, canvas.height - padding + 20);
            });

            // Y-axis labels (weights)
            ctx.textAlign = 'left';
            for (let i = 0; i <= 5; i++) {
                const weight = minWeight + (range / 5) * (5 - i);
                const y = padding + (chartHeight / 5) * i;
                ctx.fillText(weight.toFixed(1), padding - 50, y + 5);
            }
        }

        function renderEntries() {
            const container = document.getElementById('entriesList');
            const count = document.getElementById('entriesCount');

            count.textContent = entries.length;

            if (entries.length === 0) {
                container.className = 'empty-state';
                container.innerHTML = '×¢×“×™×™×Ÿ ××™×Ÿ ×¨×©×•××•×ª. ×”×ª×—×™×œ×™ ×œ××œ× ××ª ×”×˜×•×¤×¡ ×œ××¢×œ×” ×›×“×™ ×œ×”×ª×—×™×œ ×‘××¢×§×‘! ğŸ’ª';
                return;
            }

            container.className = 'entries-grid';
            container.innerHTML = entries.map(entry => {
                const date = new Date(entry.date);
                const dateStr = date.toLocaleDateString('he-IL', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });

                return `
                    <div class="entry-card">
                        <div class="entry-header">
                            <div class="entry-date">${dateStr}</div>
                            <div class="entry-actions">
                                <button class="btn-edit" onclick="editEntry(${entry.id})">×¢×¨×•×š</button>
                                <button class="btn-delete" onclick="deleteEntry(${entry.id})">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                        <div class="entry-data">
                            ${entry.weight ? `
                                <div>
                                    <div class="data-item-label">××©×§×œ:</div>
                                    <div class="data-item-value" style="color: #10b981;">${entry.weight} ×§×´×’</div>
                                </div>
                            ` : ''}
                            ${entry.dosage ? `
                                <div>
                                    <div class="data-item-label">××™× ×•×Ÿ:</div>
                                    <div class="data-item-value" style="color: #8b5cf6;">${entry.dosage} mg</div>
                                </div>
                            ` : ''}
                            ${entry.bowelMovements ? `
                                <div>
                                    <div class="data-item-label">×™×¦×™××•×ª:</div>
                                    <div class="data-item-value" style="color: #f59e0b;">${entry.bowelMovements}</div>
                                </div>
                            ` : ''}
                            ${entry.waterIntake ? `
                                <div>
                                    <div class="data-item-label">××™×:</div>
                                    <div class="data-item-value" style="color: #3b82f6;">${entry.waterIntake} ×œ×™×˜×¨</div>
                                </div>
                            ` : ''}
                        </div>
                        ${entry.sideEffects ? `
                            <div class="side-effects">
                                <span class="side-effects-label">×ª×•×¤×¢×•×ª ×œ×•×•××™:</span>
                                <span class="side-effects-text">${entry.sideEffects}</span>
                            </div>
                        ` : ''}
                        ${entry.notes ? `
                            <div class="notes">${entry.notes}</div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }
    </script>
</body>
</html>
